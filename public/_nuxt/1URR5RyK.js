import{V as ie,W as et,X as tt,Y as at,M as Ie,Z as lt,n as oe,_ as ot,$ as nt,a0 as st,a1 as rt,B as Le,a2 as it,a3 as ut,J as ue,K as re,a4 as dt,a5 as ct,a6 as mt,l as pt,s as ft,t as de,o as xe,E as Ce,p as _t,a7 as gt,z as Ae,r as ze,a8 as vt,j as bt,q as ht,m as Ve,i as yt}from"./B9wLchKa.js";import{E as Se}from"./CLBa9eu9.js";import{g as wt,E as De,a as kt,v as Ne}from"./Dh-lkO53.js";import{E as $e,a as Oe,b as Re,d as xt,c as Ct}from"./Dg3hlzYb.js";import{E as Ke,a as He,b as Pe}from"./YLcEK7nE.js";import{u as Te,E as Me}from"./DGA5DoMI.js";import{b as je,e as me,m as Ue,i as he,u as Be,_ as Fe,w as We,f as St}from"./BOIZsV8L.js";import{d as _e,ae as Ye,r as $,af as Tt,a9 as Mt,c as S,S as ye,N as Xe,o as ge,t as i,T as Y,z as t,A as o,x as l,K,I as e,O as we,L as se,U as T,v as I,V as ae,Y as Et,W as ce,G as Ee,a3 as Dt,M as fe,ag as Yt,ah as It,ai as Lt,y as v,aj as At,E as zt,a5 as Ge,B as D,X as Vt,J as ke,_ as Nt}from"./BPBBqX13.js";import{d as $t,u as ve,a as Ot,b as Rt}from"./DTX7Vt5Z.js";import{h as pe}from"./C5S46NFB.js";import{E as Kt,a as Ht}from"./COawGGrN.js";import{a as Pt,E as jt}from"./DackE5MS.js";import"./l0sNRNKZ.js";import"./CY9tAmGA.js";import"./Cpj98o6Y.js";const Ut=(s,b)=>{if(!ie||!s||!b)return!1;const p=s.getBoundingClientRect();let d;return b instanceof Element?d=b.getBoundingClientRect():d={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},p.top<d.bottom&&p.bottom>d.top&&p.right>d.left&&p.left<d.right};var Bt="Expected a function";function be(s,b,p){var d=!0,f=!0;if(typeof s!="function")throw new TypeError(Bt);return et(p)&&(d="leading"in p?!!p.leading:d,f="trailing"in p?!!p.trailing:f),$t(s,b,{leading:d,maxWait:b,trailing:f})}const Ft=je({urlList:{type:me(Array),default:()=>Ue([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:me(String)}}),Wt={close:()=>!0,switch:s=>he(s),rotate:s=>he(s)},Xt=["src","crossorigin"],Gt=_e({name:"ElImageViewer"}),Jt=_e({...Gt,props:Ft,emits:Wt,setup(s,{expose:b,emit:p}){var d;const f=s,y={CONTAIN:{name:"contain",icon:Ye(tt)},ORIGINAL:{name:"original",icon:Ye(at)}},{t:ee}=Ie(),h=Be("image-viewer"),{nextZIndex:H}=lt(),c=$(),L=$([]),N=Tt(),E=$(!0),x=$(f.initialIndex),F=Mt(y.CONTAIN),_=$({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),te=$((d=f.zIndex)!=null?d:H()),A=S(()=>{const{urlList:u}=f;return u.length<=1}),r=S(()=>x.value===0),z=S(()=>x.value===f.urlList.length-1),w=S(()=>f.urlList[x.value]),j=S(()=>[h.e("btn"),h.e("prev"),h.is("disabled",!f.infinite&&r.value)]),G=S(()=>[h.e("btn"),h.e("next"),h.is("disabled",!f.infinite&&z.value)]),J=S(()=>{const{scale:u,deg:m,offsetX:M,offsetY:O,enableTransition:Q}=_.value;let R=M/u,X=O/u;switch(m%360){case 90:case-270:[R,X]=[X,-R];break;case 180:case-180:[R,X]=[-R,-X];break;case 270:case-90:[R,X]=[-X,R];break}const ne={transform:`scale(${u}) rotate(${m}deg) translate(${R}px, ${X}px)`,transition:Q?"transform .3s":""};return F.value.name===y.CONTAIN.name&&(ne.maxWidth=ne.maxHeight="100%"),ne});function q(){W(),p("close")}function Z(){const u=be(M=>{switch(M.code){case re.esc:f.closeOnPressEscape&&q();break;case re.space:V();break;case re.left:B();break;case re.up:C("zoomIn");break;case re.right:a();break;case re.down:C("zoomOut");break}}),m=be(M=>{const O=M.deltaY||M.deltaX;C(O<0?"zoomIn":"zoomOut",{zoomRate:f.zoomRate,enableTransition:!1})});N.run(()=>{ue(document,"keydown",u),ue(document,"wheel",m)})}function W(){N.stop()}function U(){E.value=!1}function le(u){E.value=!1,u.target.alt=ee("el.image.error")}function k(u){if(E.value||u.button!==0||!c.value)return;_.value.enableTransition=!1;const{offsetX:m,offsetY:M}=_.value,O=u.pageX,Q=u.pageY,R=be(ne=>{_.value={..._.value,offsetX:m+ne.pageX-O,offsetY:M+ne.pageY-Q}}),X=ue(document,"mousemove",R);ue(document,"mouseup",()=>{X()}),u.preventDefault()}function P(){_.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function V(){if(E.value)return;const u=dt(y),m=Object.values(y),M=F.value.name,Q=(m.findIndex(R=>R.name===M)+1)%u.length;F.value=y[u[Q]],P()}function g(u){const m=f.urlList.length;x.value=(u+m)%m}function B(){r.value&&!f.infinite||g(x.value-1)}function a(){z.value&&!f.infinite||g(x.value+1)}function C(u,m={}){if(E.value)return;const{minScale:M,maxScale:O}=f,{zoomRate:Q,rotateDeg:R,enableTransition:X}={zoomRate:f.zoomRate,rotateDeg:90,enableTransition:!0,...m};switch(u){case"zoomOut":_.value.scale>M&&(_.value.scale=Number.parseFloat((_.value.scale/Q).toFixed(3)));break;case"zoomIn":_.value.scale<O&&(_.value.scale=Number.parseFloat((_.value.scale*Q).toFixed(3)));break;case"clockwise":_.value.deg+=R,p("rotate",_.value.deg);break;case"anticlockwise":_.value.deg-=R,p("rotate",_.value.deg);break}_.value.enableTransition=X}return ye(w,()=>{Xe(()=>{const u=L.value[0];u!=null&&u.complete||(E.value=!0)})}),ye(x,u=>{P(),p("switch",u)}),ge(()=>{var u,m;Z(),(m=(u=c.value)==null?void 0:u.focus)==null||m.call(u)}),b({setActiveItem:g}),(u,m)=>(i(),Y(It,{to:"body",disabled:!u.teleported},[t(Yt,{name:"viewer-fade",appear:""},{default:o(()=>[l("div",{ref_key:"wrapper",ref:c,tabindex:-1,class:K(e(h).e("wrapper")),style:we({zIndex:te.value})},[l("div",{class:K(e(h).e("mask")),onClick:m[0]||(m[0]=se(M=>u.hideOnClickModal&&q(),["self"]))},null,2),T(" CLOSE "),l("span",{class:K([e(h).e("btn"),e(h).e("close")]),onClick:q},[t(e(oe),null,{default:o(()=>[t(e(ot))]),_:1})],2),T(" ARROW "),e(A)?T("v-if",!0):(i(),I(ae,{key:0},[l("span",{class:K(e(j)),onClick:B},[t(e(oe),null,{default:o(()=>[t(e(nt))]),_:1})],2),l("span",{class:K(e(G)),onClick:a},[t(e(oe),null,{default:o(()=>[t(e(st))]),_:1})],2)],64)),T(" ACTIONS "),l("div",{class:K([e(h).e("btn"),e(h).e("actions")])},[l("div",{class:K(e(h).e("actions__inner"))},[t(e(oe),{onClick:m[1]||(m[1]=M=>C("zoomOut"))},{default:o(()=>[t(e(rt))]),_:1}),t(e(oe),{onClick:m[2]||(m[2]=M=>C("zoomIn"))},{default:o(()=>[t(e(Le))]),_:1}),l("i",{class:K(e(h).e("actions__divider"))},null,2),t(e(oe),{onClick:V},{default:o(()=>[(i(),Y(Et(e(F).icon)))]),_:1}),l("i",{class:K(e(h).e("actions__divider"))},null,2),t(e(oe),{onClick:m[3]||(m[3]=M=>C("anticlockwise"))},{default:o(()=>[t(e(it))]),_:1}),t(e(oe),{onClick:m[4]||(m[4]=M=>C("clockwise"))},{default:o(()=>[t(e(ut))]),_:1})],2)],2),T(" CANVAS "),l("div",{class:K(e(h).e("canvas"))},[(i(!0),I(ae,null,ce(u.urlList,(M,O)=>Ee((i(),I("img",{ref_for:!0,ref:Q=>L.value[O]=Q,key:M,src:M,style:we(e(J)),class:K(e(h).e("img")),crossorigin:u.crossorigin,onLoad:U,onError:le,onMousedown:k},null,46,Xt)),[[Dt,O===x.value]])),128))],2),fe(u.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var qt=Fe(Jt,[["__file","image-viewer.vue"]]);const Zt=We(qt),Qt=je({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:me([String,Object])},previewSrcList:{type:me(Array),default:()=>Ue([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:me(String)}}),ea={load:s=>s instanceof Event,error:s=>s instanceof Event,switch:s=>he(s),close:()=>!0,show:()=>!0},ta=["src","loading","crossorigin"],aa={key:0},la=_e({name:"ElImage",inheritAttrs:!1}),oa=_e({...la,props:Qt,emits:ea,setup(s,{emit:b}){const p=s;let d="";const{t:f}=Ie(),y=Be("image"),ee=Lt(),h=ct(),H=$(),c=$(!1),L=$(!0),N=$(!1),E=$(),x=$(),F=ie&&"loading"in HTMLImageElement.prototype;let _,te;const A=S(()=>[y.e("inner"),w.value&&y.e("preview"),L.value&&y.is("loading")]),r=S(()=>ee.style),z=S(()=>{const{fit:a}=p;return ie&&a?{objectFit:a}:{}}),w=S(()=>{const{previewSrcList:a}=p;return Array.isArray(a)&&a.length>0}),j=S(()=>{const{previewSrcList:a,initialIndex:C}=p;let u=C;return C>a.length-1&&(u=0),u}),G=S(()=>p.loading==="eager"?!1:!F&&p.loading==="lazy"||p.lazy),J=()=>{ie&&(L.value=!0,c.value=!1,H.value=p.src)};function q(a){L.value=!1,c.value=!1,b("load",a)}function Z(a){L.value=!1,c.value=!0,b("error",a)}function W(){Ut(E.value,x.value)&&(J(),k())}const U=mt(W,200,!0);async function le(){var a;if(!ie)return;await Xe();const{scrollContainer:C}=p;St(C)?x.value=C:zt(C)&&C!==""?x.value=(a=document.querySelector(C))!=null?a:void 0:E.value&&(x.value=wt(E.value)),x.value&&(_=ue(x,"scroll",U),setTimeout(()=>W(),100))}function k(){!ie||!x.value||!U||(_==null||_(),x.value=void 0)}function P(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function V(){w.value&&(te=ue("wheel",P,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",N.value=!0,b("show"))}function g(){te==null||te(),document.body.style.overflow=d,N.value=!1,b("close")}function B(a){b("switch",a)}return ye(()=>p.src,()=>{G.value?(L.value=!0,c.value=!1,k(),le()):J()}),ge(()=>{G.value?le():J()}),(a,C)=>(i(),I("div",{ref_key:"container",ref:E,class:K([e(y).b(),a.$attrs.class]),style:we(e(r))},[c.value?fe(a.$slots,"error",{key:0},()=>[l("div",{class:K(e(y).e("error"))},v(e(f)("el.image.error")),3)]):(i(),I(ae,{key:1},[H.value!==void 0?(i(),I("img",At({key:0},e(h),{src:H.value,loading:a.loading,style:e(z),class:e(A),crossorigin:a.crossorigin,onClick:V,onLoad:q,onError:Z}),null,16,ta)):T("v-if",!0),L.value?(i(),I("div",{key:1,class:K(e(y).e("wrapper"))},[fe(a.$slots,"placeholder",{},()=>[l("div",{class:K(e(y).e("placeholder"))},null,2)])],2)):T("v-if",!0)],64)),e(w)?(i(),I(ae,{key:2},[N.value?(i(),Y(e(Zt),{key:0,"z-index":a.zIndex,"initial-index":e(j),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:g,onSwitch:B},{default:o(()=>[a.$slots.viewer?(i(),I("div",aa,[fe(a.$slots,"viewer")])):T("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):T("v-if",!0)],64)):T("v-if",!0)],6))}});var na=Fe(oa,[["__file","image.vue"]]);const sa=We(na),ra={class:"flex flex-row"},ia={class:"table-auto",style:{"min-width":"360px"}},ua=l("td",{style:{width:"150px"},class:"border bg-blue-700 text-white px-4 py-1"}," Nomor Barcode ",-1),da={class:"border bg-blue-100 px-4 py-1"},ca=l("td",{class:"border bg-blue-700 text-white px-4 py-1"}," Jenis Kendaraan ",-1),ma={class:"border bg-blue-100 px-4 py-1"},pa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Plat Nomor",-1),fa={class:"border bg-blue-100 px-4 py-1"},_a=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Member",-1),ga={class:"border bg-blue-100 px-4 py-1"},va=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Nomor Kartu",-1),ba={class:"border bg-blue-100 px-4 py-1"},ha=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Gate Masuk",-1),ya={class:"border bg-blue-100 px-4 py-1"},wa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Gate Keluar",-1),ka={class:"border bg-blue-100 px-4 py-1"},xa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Waktu Masuk",-1),Ca={class:"border bg-blue-100 px-4 py-1"},Sa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"}," Waktu Keluar ",-1),Ta={class:"border bg-blue-100 px-4 py-1"},Ma=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Durasi",-1),Ea={class:"border bg-blue-100 px-4 py-1"},Da={key:0},Ya=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Tarif",-1),Ia={class:"border bg-blue-100 px-4 py-1"},La={key:1},Aa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Denda",-1),za={class:"border bg-blue-100 px-4 py-1"},Va=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Operator",-1),Na={class:"border bg-blue-100 px-4 py-1"},$a=["src"],Oa={__name:"DetailTransaksi",props:["trx","show"],emits:["close"],setup(s,{emit:b}){const p=Te(),d=Ge(),f=b,{toRupiah:y}=ve(),ee=S(()=>p.setting),h=S(()=>d.user.value);return(H,c)=>{const L=Me;return i(),Y(L,{center:"",width:"80%",title:"DETAIL TRANSAKSI","model-value":s.show,"before-close":()=>f("close")},{default:o(()=>[l("div",ra,[l("table",ia,[l("tbody",null,[l("tr",null,[ua,l("td",da,v(s.trx.nomor_barcode),1)]),l("tr",null,[ca,l("td",ma,v(s.trx.jenis_kendaraan),1)]),l("tr",null,[pa,l("td",fa,v(s.trx.plat_nomor),1)]),l("tr",null,[_a,l("td",ga,v(s.trx.is_member?s.trx.member.nama:"Tidak"),1)]),l("tr",null,[va,l("td",ba,v(s.trx.nomor_kartu),1)]),l("tr",null,[ha,l("td",ya,v(s.trx.gate_in?s.trx.gate_in.nama:""),1)]),l("tr",null,[wa,l("td",ka,v(s.trx.gate_out?s.trx.gate_out.nama:""),1)]),l("tr",null,[xa,l("td",Ca,v(e(pe)(s.trx.time_in).format("DD-MMM-YYYY HH:mm:ss")),1)]),l("tr",null,[Sa,l("td",Ta,v(s.trx.time_out?e(pe)(s.trx.time_out).format("DD-MMM-YYYY HH:mm:ss"):""),1)]),l("tr",null,[Ma,l("td",Ea,v(s.trx.durasi),1)]),e(h).role==1?(i(),I("tr",Da,[Ya,l("td",Ia,v(e(y)(s.trx.tarif)),1)])):T("",!0),e(h).role==1?(i(),I("tr",La,[Aa,l("td",za,v(e(y)(s.trx.denda)),1)])):T("",!0),l("tr",null,[Va,l("td",Na,v(s.trx.operator),1)])])]),s.trx.snapshots?(i(),I("div",{key:0,class:K({"ml-3":!0,"flex-grow":!0,flex:e(ee).orientasi_kamera=="POTRAIT"}),style:{width:"100%"}},[(i(!0),I(ae,null,ce(s.trx.snapshots,N=>(i(),I("div",{class:"mb-1",style:{width:"100%"},key:N.id},[l("img",{src:N.url,style:{width:"100%"}},null,8,$a)]))),128))],2)):T("",!0)])]),_:1},8,["model-value","before-close"])}}},Ra={__name:"FormTransaksiManual",props:["show","model"],emits:["close","reload"],setup(s,{emit:b}){const{api:p,formErrors:d}=ve(),f=Te(),y=b,{show:ee,model:h}=s,H=$(!1),c=S(()=>h),L=S(()=>f.pos),N=S(()=>f.gateOutList),E=S(()=>f.gateInList),x=S(()=>f.jenisKendaraanList),F=()=>{d.value={},y("close")},_=()=>{H.value=!0,c.value.manual=1,p("/api/parkingTransaction",{method:"POST",body:c.value}).then(({data:A,message:r})=>{de({message:r,type:"success",showClose:!0}),F(),y("reload"),te(A.gate_out_id)}).catch(A=>{var r;((r=A.response)==null?void 0:r.status)==422?d.value=A.response._data.errors:console.log(A)}).finally(()=>H.value=!1)},te=A=>{const r=N.value.find(w=>w.id==A),z=new WebSocket(`ws://${L.value.ip_address}:5678/`);z.onerror=w=>{de({message:"KONEKSI KE POS GAGAL",type:"error"})},z.onopen=w=>{z.send(["open",r.device,r.baudrate,r.open_command,r.close_command].join(";"))},z.onmessage=w=>{let j=JSON.parse(w.data);de({message:j.message,type:j.status?"success":"error"}),z.close()}};return(A,r)=>{const z=xe,w=Kt,j=Ot,G=Rt,J=Se,q=Pt,Z=jt,W=Ht,U=Ce,le=Me;return i(),Y(le,{"close-on-click-modal":!1,title:e(c).id?"EDIT TRANSAKSI "+e(c).nomor_barcode:"TRANSAKSI MANUAL","model-value":s.show,width:"800px","before-close":k=>F()},{footer:o(()=>[t(U,{icon:e(pt),onClick:F},{default:o(()=>[D(" BATAL ")]),_:1},8,["icon"]),t(U,{type:"primary",icon:e(ft),onClick:_},{default:o(()=>[D(" SIMPAN ")]),_:1},8,["icon"])]),default:o(()=>[t(W,{"label-position":"left","label-width":"150px"},{default:o(()=>[t(Z,{gutter:30},{default:o(()=>[t(q,{span:12},{default:o(()=>{var k,P,V,g,B;return[t(w,{label:"Plat Nomor",error:(k=e(d).plat_nomor)==null?void 0:k.join(", ")},{default:o(()=>[t(z,{placeholder:"Plat Nomor",modelValue:e(c).plat_nomor,"onUpdate:modelValue":r[0]||(r[0]=a=>e(c).plat_nomor=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Gate Masuk",error:(P=e(d).gate_in_id)==null?void 0:P.join(", ")},{default:o(()=>[t(G,{modelValue:e(c).gate_in_id,"onUpdate:modelValue":r[1]||(r[1]=a=>e(c).gate_in_id=a),placeholder:"Gate Masuk",style:{width:"100%"}},{default:o(()=>[(i(!0),I(ae,null,ce(e(E),(a,C)=>(i(),Y(j,{value:a.id,label:a.nama,key:C},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Waktu Masuk",error:(V=e(d).time_in)==null?void 0:V.join(", ")},{default:o(()=>[t(J,{type:"datetime",style:{width:"100%"},format:"DD-MMM-YYYY HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"Waktu Masuk",modelValue:e(c).time_in,"onUpdate:modelValue":r[2]||(r[2]=a=>e(c).time_in=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Tarif (Rp)",error:(g=e(d).tarif)==null?void 0:g.join(", ")},{default:o(()=>[t(z,{type:"number",placeholder:"Tarif",modelValue:e(c).tarif,"onUpdate:modelValue":r[3]||(r[3]=a=>e(c).tarif=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"User Admin",error:(B=e(d).username)==null?void 0:B.join(", ")},{default:o(()=>[t(z,{placeholder:"User Admin",modelValue:e(c).username,"onUpdate:modelValue":r[4]||(r[4]=a=>e(c).username=a)},null,8,["modelValue"])]),_:1},8,["error"])]}),_:1}),t(q,{span:12},{default:o(()=>{var k,P,V,g,B;return[t(w,{label:"Jenis Kendaraan",error:(k=e(d).jenis_kendaraan)==null?void 0:k.join(", ")},{default:o(()=>[t(G,{modelValue:e(c).jenis_kendaraan,"onUpdate:modelValue":r[5]||(r[5]=a=>e(c).jenis_kendaraan=a),placeholder:"Jenis Kendaraan",style:{width:"100%"}},{default:o(()=>[(i(!0),I(ae,null,ce(e(x),(a,C)=>(i(),Y(j,{value:a.nama,label:a.nama,key:C},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Gate Keluar",error:(P=e(d).gate_out_id)==null?void 0:P.join(", ")},{default:o(()=>[t(G,{modelValue:e(c).gate_out_id,"onUpdate:modelValue":r[6]||(r[6]=a=>e(c).gate_out_id=a),placeholder:"Gate Keluar",style:{width:"100%"}},{default:o(()=>[(i(!0),I(ae,null,ce(e(N),(a,C)=>(i(),Y(j,{value:a.id,label:a.nama,key:C},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Waktu Keluar",error:(V=e(d).time_out)==null?void 0:V.join(", ")},{default:o(()=>[t(J,{type:"datetime",autocomplete:!1,style:{width:"100%"},format:"DD-MMM-YYYY HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"Waktu Keluar",modelValue:e(c).time_out,"onUpdate:modelValue":r[7]||(r[7]=a=>e(c).time_out=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Denda (Rp)",error:(g=e(d).denda)==null?void 0:g.join(", ")},{default:o(()=>[t(z,{type:"number",placeholder:"Denda",modelValue:e(c).denda,"onUpdate:modelValue":r[8]||(r[8]=a=>e(c).denda=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(w,{label:"Password Admin",error:(B=e(d).password)==null?void 0:B.join(", ")},{default:o(()=>[t(z,{type:"password",placeholder:"Password Admin",modelValue:e(c).password,"onUpdate:modelValue":r[9]||(r[9]=a=>e(c).password=a)},null,8,["modelValue"])]),_:1},8,["error"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["title","model-value","before-close"])}}},Ka={class:"mr-2"},Ha=l("br",null,null,-1),Pa=l("br",null,null,-1),ja=l("br",null,null,-1),Ua={key:0,style:{"font-weight":"bold"}},Ba=l("br",null,null,-1),Fa=l("br",null,null,-1),Wa={class:"el-dropdown-link"},Xa=l("br",null,null,-1),Ga={__name:"ParkingTransaction",setup(s){const b=Te(),p=Ge(),{api:d,showForm:f,formErrors:y,formModel:ee,pageSize:h,tableData:H,loading:c,filters:L,keyword:N,openForm:E,currentChange:x,sizeChange:F,sortChange:_,filterChange:te,requestData:A,searchData:r,refreshData:z,toRupiah:w}=ve("/api/parkingTransaction"),j=S(()=>b.jenisKendaraanList),G=S(()=>b.gateInList),J=S(()=>b.gateOutList),q=S(()=>b.shiftList),Z=S(()=>p.user.value),W=$(null),U=$(null);Vt(()=>{b.getShiftList(),b.getPos()}),ge(()=>{L.value.dateRange=[],A()});const le=V=>{De.confirm("Anda yakin?","Confirm",{type:"warning"}).then(()=>d(`/api/parkingTransaction/setSudahKeluar/${V}`,{method:"PUT"})).then(g=>{de({message:g.message,type:"success"}),A()})},k=()=>{De.confirm("Anda yakin?","Confirm",{type:"warning"}).then(()=>d("/api/parkingTransaction/setSudahKeluarSemua",{method:"PUT",body:{dateRange:L.value.dateRange}})).then(V=>{de({message:V.message,type:"success"}),A()}).catch(V=>console.log(V))},P=V=>{d(`/api/parkingTransaction/printTicketOut/${V}`,{method:"POST"}).then(g=>{de({message:g.message,type:"success"})})};return(V,g)=>{const B=Ce,a=Se,C=kt,u=xe,m=$e,M=oe,O=Ke,Q=He,R=Pe,X=Oe,ne=Re,Je=Oa,qe=Ra,Ze=Ne;return i(),I(ae,null,[l("form",{class:"flex justify-content-end mb-3",onSubmit:g[3]||(g[3]=se(()=>{},["prevent"]))},[t(B,{size:"small",type:"primary",icon:e(_t),onClick:g[0]||(g[0]=n=>e(E)({})),class:"mr-2"},{default:o(()=>[D(" TRANSAKSI MANUAL ")]),_:1},8,["icon"]),l("div",Ka,[t(a,{size:"small",onChange:e(A),modelValue:e(L).dateRange,"onUpdate:modelValue":g[1]||(g[1]=n=>e(L).dateRange=n),format:"DD-MMM-YYYY HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"Dari","end-placeholder":"Sampai"},null,8,["onChange","modelValue"])]),e(Z).role==1?(i(),Y(C,{key:0,class:"item",effect:"dark",content:"Set kendaraan sudah keluar untuk waktu terpilih",placement:"bottom"},{default:o(()=>[t(B,{size:"small",type:"danger",icon:e(gt),onClick:k,class:"mr-2"},null,8,["icon"])]),_:1})):T("",!0),t(u,{size:"small",modelValue:e(N),"onUpdate:modelValue":g[2]||(g[2]=n=>ke(N)?N.value=n:null),placeholder:"Cari","prefix-icon":e(Ae),clearable:!0,onChange:e(r),style:{width:"150px"}},null,8,["modelValue","prefix-icon","onChange"])],32),Ee((i(),Y(X,{data:e(H).data,stripe:"",onRowDblclick:g[4]||(g[4]=n=>{W.value=n,U.value=!0}),onFilterChange:e(te),height:"calc(100vh - 240px)",onSortChange:e(_)},{default:o(()=>[t(m,{label:"No. Tiket",sortable:"custom",filters:e(j).map(n=>({value:n.nama,text:n.nama})),"column-key":"jenis_kendaraan","min-width":"150","show-overflow-tooltip":""},{default:o(({row:n})=>[l("strong",null,v(n.nomor_barcode),1),Ha,D(" "+v(n.jenis_kendaraan)+" "+v(n.plat_nomor?`- ${n.plat_nomor}`:""),1)]),_:1},8,["filters"]),t(m,{prop:"time_in",label:"Masuk",sortable:"custom","show-overflow-tooltip":"","min-width":"140px","column-key":"gate_in_id",filters:e(G).map(n=>({value:n.id,text:n.nama}))},{default:o(({row:n})=>[D(v(e(pe)(n.time_in).format("DD/MMM/YY HH:mm"))+" ",1),Pa,D(" "+v(n.gate_in.nama),1)]),_:1},8,["filters"]),t(m,{prop:"time_out",label:"Keluar",sortable:"custom","show-overflow-tooltip":"","min-width":"140px","column-key":"gate_out_id",filters:e(J).map(n=>({value:n.id,text:n.nama}))},{default:o(({row:n})=>[D(v(n.time_out?e(pe)(n.time_out).format("DD/MMM/YY HH:mm"):"")+" ",1),ja,D(" "+v(n.gate_out?n.gate_out.nama:"-"),1)]),_:1},8,["filters"]),t(m,{label:"Durasi","show-overflow-tooltip":"",prop:"parking_transactions.tarif",sortable:"custom","min-width":"120px"},{default:o(({row:n})=>[D(v(n.durasi)+" ",1),e(Z).role==1?(i(),I("div",Ua,v(e(w)(n.tarif)),1)):T("",!0)]),_:1}),e(Z).role==1?(i(),Y(m,{key:0,prop:"denda",label:"Denda",align:"right","column-key":"denda",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"header-align":"right","min-width":"100px"},{default:o(({row:n})=>[D(v(e(w)(n.denda)),1)]),_:1})):T("",!0),t(m,{label:"Member",sortable:"custom","show-overflow-tooltip":"","min-width":"120"},{default:o(({row:n})=>[l("strong",null,v(n.member?n.member.nama:""),1),D(),Ba,D(" "+v(n.nomor_kartu),1)]),_:1}),t(m,{prop:"operator",label:"Operator","show-overflow-tooltip":"","min-width":"90"}),t(m,{label:"Shift",prop:"shift.nama","column-key":"shift_id","min-width":"80",filters:e(q).map(n=>({value:n.id,text:n.nama}))},null,8,["filters"]),t(m,{label:"Edit",align:"center","header-align":"center","column-key":"edit",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"min-width":"100px"},{default:o(({row:n})=>[D(v(n.edit?"YA":"TIDAK")+" ",1),Fa,D(" "+v(n.edit_by),1)]),_:1}),t(m,{label:"Manual",align:"center","header-align":"center","column-key":"manual",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"min-width":"100px"},{default:o(({row:n})=>[D(v(n.manual?"YA":"TIDAK"),1)]),_:1}),t(m,{fixed:"right",width:"60px",align:"center","header-align":"center"},{header:o(()=>[t(B,{link:"",onClick:e(z),icon:e(ze)},null,8,["onClick","icon"])]),default:o(({row:n})=>[t(R,null,{dropdown:o(()=>[t(Q,null,{default:o(()=>[t(O,{icon:e(Le),onClick:se(()=>{W.value=n,U.value=!0},["prevent"])},{default:o(()=>[D(" Lihat Detail ")]),_:2},1032,["icon","onClick"]),!n.time_out&&e(Z).role==1?(i(),Y(O,{key:0,icon:e(vt),onClick:se(Qe=>le(n.id),["prevent"])},{default:o(()=>[D(" Set Sudah Keluar ")]),_:2},1032,["icon","onClick"])):T("",!0),!n.is_member&&!n.edit&&!n.manual?(i(),Y(O,{key:1,icon:e(bt),onClick:se(()=>{ee.value={...n},y.value={},f.value=!0},["prevent"])},{default:o(()=>[D(" Edit ")]),_:2},1032,["icon","onClick"])):T("",!0),!n.is_member&&n.time_out?(i(),Y(O,{key:2,icon:e(ht),onClick:se(Qe=>P(n.id),["prevent"])},{default:o(()=>[D(" Print Tiket Keluar ")]),_:2},1032,["icon","onClick"])):T("",!0)]),_:2},1024)]),default:o(()=>[l("span",Wa,[t(M,null,{default:o(()=>[t(e(Ve))]),_:1})])]),_:2},1024)]),_:1})]),_:1},8,["data","onFilterChange","onSortChange"])),[[Ze,e(c)]]),Xa,e(H).total?(i(),Y(ne,{key:0,small:"",background:"",layout:"total, sizes, prev, pager, next","page-size":e(h),"page-sizes":[10,25,50,100],total:e(H).total,onCurrentChange:e(x),onSizeChange:e(F)},null,8,["page-size","total","onCurrentChange","onSizeChange"])):T("",!0),e(W)?(i(),Y(Je,{key:1,trx:e(W),show:e(U),onClose:g[5]||(g[5]=n=>U.value=!1)},null,8,["trx","show"])):T("",!0),e(f)?(i(),Y(qe,{key:2,show:e(f),model:e(ee),onClose:g[6]||(g[6]=n=>f.value=!1),onReload:e(A)},null,8,["show","model","onReload"])):T("",!0)],64)}}},Ja={class:"el-dropdown-link"},qa=l("br",null,null,-1),Za=l("div",{slot:"error",class:"el-image__error"},[l("i",{class:"el-icon-picture-outline"})],-1),Qa={__name:"ManualOpenLog",setup(s){const{pageSize:b,tableData:p,loading:d,filters:f,keyword:y,currentChange:ee,sizeChange:h,sortChange:H,requestData:c,refreshData:L,searchData:N}=ve("/api/manualOpenLog"),E=$(!1),x=$([]);return ge(()=>{f.value.dateRange=[],c()}),(F,_)=>{const te=Se,A=xe,r=$e,z=Ce,w=oe,j=Ke,G=He,J=Pe,q=Oe,Z=Re,W=sa,U=Me,le=Ne;return i(),I(ae,null,[l("form",{class:"flex justify-content-end mb-3",onSubmit:_[2]||(_[2]=se(()=>{},["prevent"]))},[l("div",null,[t(te,{size:"small",onChange:e(c),modelValue:e(f).dateRange,"onUpdate:modelValue":_[0]||(_[0]=k=>e(f).dateRange=k),format:"DD-MMM-YYYY HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"Dari","end-placeholder":"Sampai",class:"mr-2"},null,8,["onChange","modelValue"])]),t(A,{size:"small",modelValue:e(y),"onUpdate:modelValue":_[1]||(_[1]=k=>ke(y)?y.value=k:null),placeholder:"Cari","prefix-icon":e(Ae),clearable:"",onChange:e(N),style:{width:"200px"}},null,8,["modelValue","prefix-icon","onChange"])],32),Ee((i(),Y(q,{data:e(p).data,stripe:"",onRowDblclick:_[3]||(_[3]=(k,P,V)=>{x.value=k.snapshots,E.value=!0}),height:"calc(100vh - 240px)",onSortChange:e(H)},{default:o(()=>[t(r,{type:"index",index:e(p).from,label:"#"},null,8,["index"]),t(r,{prop:"created_at",label:"Tanggal",sortable:"custom","show-overflow-tooltip":"",width:"180px"},{default:o(({row:k})=>[D(v(e(pe)(k.created_at).format("DD-MMM-YYYY HH:mm:ss")),1)]),_:1}),t(r,{prop:"gate_out.nama",label:"Gate Out","show-overflow-tooltip":"","min-width":"150px"}),t(r,{prop:"user.name",label:"Operator","show-overflow-tooltip":"","min-width":"150px"}),t(r,{prop:"alasan",label:"Alasan",sortable:"custom","show-overflow-tooltip":"","min-width":"150px"}),t(r,{fixed:"right",width:"60px",align:"center","header-align":"center"},{header:o(()=>[t(z,{link:"",onClick:e(L),icon:e(ze)},null,8,["onClick","icon"])]),default:o(({row:k})=>[t(J,null,{dropdown:o(()=>[t(G,null,{default:o(()=>[t(j,{icon:e(yt),onClick:se(()=>{x.value=k.snapshots,E.value=!0},["prevent"])},{default:o(()=>[D("Lihat Snapshot")]),_:2},1032,["icon","onClick"])]),_:2},1024)]),default:o(()=>[l("span",Ja,[t(w,null,{default:o(()=>[t(e(Ve))]),_:1})])]),_:2},1024)]),_:1})]),_:1},8,["data","onSortChange"])),[[le,e(d)]]),qa,e(p).total?(i(),Y(Z,{key:0,small:"",background:"",layout:"total, sizes, prev, pager, next","page-size":e(b),"page-sizes":[10,25,50,100],total:e(p).total,onCurrentChange:e(ee),onSizeChange:e(h)},null,8,["page-size","total","onCurrentChange","onSizeChange"])):T("",!0),t(U,{center:"",modelValue:e(E),"onUpdate:modelValue":_[4]||(_[4]=k=>ke(E)?E.value=k:null),title:"SNAPSHOT"},{default:o(()=>[(i(!0),I(ae,null,ce(e(x),(k,P)=>(i(),Y(W,{key:P,src:k.url,style:{width:"100%",height:"100%"},fit:"cover"},{default:o(()=>[Za]),_:2},1032,["src"]))),128))]),_:1},8,["modelValue"])],64)}}},el={};function tl(s,b){const p=Ga,d=Ct,f=Qa,y=xt;return i(),Y(y,null,{default:o(()=>[t(d,{label:"TRANSAKSI PARKIR"},{default:o(()=>[t(p)]),_:1}),t(d,{label:"BUKA MANUAL"},{default:o(()=>[t(f)]),_:1})]),_:1})}const vl=Nt(el,[["render",tl]]);export{vl as default};
