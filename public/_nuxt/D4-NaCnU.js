import{J as ie,K as tt,L as at,M as lt,x as Ie,N as ot,k as ae,O as nt,P as st,Q as rt,R as it,z as Le,S as ut,T as dt,u as ue,v as re,U as ct,V as mt,W as pt,c as ft,s as _t,E as de,a as xe,b as gt,d as vt,e as Ce,p as bt,X as ht,l as Ae,r as ze,Y as yt,h as wt,g as kt,m as Ve,F as xt}from"./B5bBtCv3.js";import{E as Se}from"./OnYn2HpR.js";import{g as Ct,E as De,a as St}from"./fxtIobu3.js";import{E as Ne,a as Re,b as $e}from"./D2QCMOxE.js";import{E as Oe,a as Ke,b as He}from"./DWIKEbko.js";import{E as Te}from"./Bzw_Yph2.js";import{b as Pe,d as me,m as je,a as he,u as Ue,_ as Be,w as Fe,c as Tt}from"./SLZFS4qm.js";import{u as Ee}from"./BtOwUbb7.js";import{d as _e,ac as Ye,r as N,ad as Et,a7 as Mt,c as T,a3 as ye,a4 as We,o as ge,t as c,M as z,z as t,A as o,x as l,T as O,E as e,Y as we,V as se,N as D,v as Y,H as le,Z as Dt,I as ce,F as Me,S as Yt,X as fe,ae as It,af as Lt,ag as At,y as g,ah as zt,a6 as Vt,U as Xe,B as M,a9 as Nt,W as ke,_ as Rt}from"./Bntytgkf.js";import{e as $t,u as ve,E as Ot,a as Kt,b as Ht}from"./D3AmPUjB.js";import{h as pe}from"./C5S46NFB.js";import{a as Pt,E as jt}from"./BZz-OvdB.js";import{v as Ge}from"./CNfAV5O5.js";import{E as Ut,a as Bt}from"./D8XTrUh_.js";import"./CY9tAmGA.js";import"./Cpj98o6Y.js";const Ft=(r,h)=>{if(!ie||!r||!h)return!1;const p=r.getBoundingClientRect();let d;return h instanceof Element?d=h.getBoundingClientRect():d={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},p.top<d.bottom&&p.bottom>d.top&&p.right>d.left&&p.left<d.right};var Wt="Expected a function";function be(r,h,p){var d=!0,m=!0;if(typeof r!="function")throw new TypeError(Wt);return tt(p)&&(d="leading"in p?!!p.leading:d,m="trailing"in p?!!p.trailing:m),$t(r,h,{leading:d,maxWait:h,trailing:m})}const Xt=Pe({urlList:{type:me(Array),default:()=>je([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:me(String)}}),Gt={close:()=>!0,switch:r=>he(r),rotate:r=>he(r)},Jt=["src","crossorigin"],qt=_e({name:"ElImageViewer"}),Zt=_e({...qt,props:Xt,emits:Gt,setup(r,{expose:h,emit:p}){var d;const m=r,w={CONTAIN:{name:"contain",icon:Ye(at)},ORIGINAL:{name:"original",icon:Ye(lt)}},{t:U}=Ie(),y=Ue("image-viewer"),{nextZIndex:B}=ot(),i=N(),V=N([]),A=Et(),E=N(!0),C=N(m.initialIndex),F=Mt(w.CONTAIN),f=N({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),te=N((d=m.zIndex)!=null?d:B()),R=T(()=>{const{urlList:u}=m;return u.length<=1}),s=T(()=>C.value===0),I=T(()=>C.value===m.urlList.length-1),x=T(()=>m.urlList[C.value]),K=T(()=>[y.e("btn"),y.e("prev"),y.is("disabled",!m.infinite&&s.value)]),Z=T(()=>[y.e("btn"),y.e("next"),y.is("disabled",!m.infinite&&I.value)]),Q=T(()=>{const{scale:u,deg:b,offsetX:_,offsetY:J,enableTransition:P}=f.value;let $=_/u,q=J/u;switch(b%360){case 90:case-270:[$,q]=[q,-$];break;case 180:case-180:[$,q]=[-$,-q];break;case 270:case-90:[$,q]=[-q,$];break}const ne={transform:`scale(${u}) rotate(${b}deg) translate(${$}px, ${q}px)`,transition:P?"transform .3s":""};return F.value.name===w.CONTAIN.name&&(ne.maxWidth=ne.maxHeight="100%"),ne});function ee(){W(),p("close")}function oe(){const u=be(_=>{switch(_.code){case re.esc:m.closeOnPressEscape&&ee();break;case re.space:G();break;case re.left:v();break;case re.up:S("zoomIn");break;case re.right:a();break;case re.down:S("zoomOut");break}}),b=be(_=>{const J=_.deltaY||_.deltaX;S(J<0?"zoomIn":"zoomOut",{zoomRate:m.zoomRate,enableTransition:!1})});A.run(()=>{ue(document,"keydown",u),ue(document,"wheel",b)})}function W(){A.stop()}function j(){E.value=!1}function X(u){E.value=!1,u.target.alt=U("el.image.error")}function k(u){if(E.value||u.button!==0||!i.value)return;f.value.enableTransition=!1;const{offsetX:b,offsetY:_}=f.value,J=u.pageX,P=u.pageY,$=be(ne=>{f.value={...f.value,offsetX:b+ne.pageX-J,offsetY:_+ne.pageY-P}}),q=ue(document,"mousemove",$);ue(document,"mouseup",()=>{q()}),u.preventDefault()}function H(){f.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function G(){if(E.value)return;const u=ct(w),b=Object.values(w),_=F.value.name,P=(b.findIndex($=>$.name===_)+1)%u.length;F.value=w[u[P]],H()}function L(u){const b=m.urlList.length;C.value=(u+b)%b}function v(){s.value&&!m.infinite||L(C.value-1)}function a(){I.value&&!m.infinite||L(C.value+1)}function S(u,b={}){if(E.value)return;const{minScale:_,maxScale:J}=m,{zoomRate:P,rotateDeg:$,enableTransition:q}={zoomRate:m.zoomRate,rotateDeg:90,enableTransition:!0,...b};switch(u){case"zoomOut":f.value.scale>_&&(f.value.scale=Number.parseFloat((f.value.scale/P).toFixed(3)));break;case"zoomIn":f.value.scale<J&&(f.value.scale=Number.parseFloat((f.value.scale*P).toFixed(3)));break;case"clockwise":f.value.deg+=$,p("rotate",f.value.deg);break;case"anticlockwise":f.value.deg-=$,p("rotate",f.value.deg);break}f.value.enableTransition=q}return ye(x,()=>{We(()=>{const u=V.value[0];u!=null&&u.complete||(E.value=!0)})}),ye(C,u=>{H(),p("switch",u)}),ge(()=>{var u,b;oe(),(b=(u=i.value)==null?void 0:u.focus)==null||b.call(u)}),h({setActiveItem:L}),(u,b)=>(c(),z(Lt,{to:"body",disabled:!u.teleported},[t(It,{name:"viewer-fade",appear:""},{default:o(()=>[l("div",{ref_key:"wrapper",ref:i,tabindex:-1,class:O(e(y).e("wrapper")),style:we({zIndex:te.value})},[l("div",{class:O(e(y).e("mask")),onClick:b[0]||(b[0]=se(_=>u.hideOnClickModal&&ee(),["self"]))},null,2),D(" CLOSE "),l("span",{class:O([e(y).e("btn"),e(y).e("close")]),onClick:ee},[t(e(ae),null,{default:o(()=>[t(e(nt))]),_:1})],2),D(" ARROW "),e(R)?D("v-if",!0):(c(),Y(le,{key:0},[l("span",{class:O(e(K)),onClick:v},[t(e(ae),null,{default:o(()=>[t(e(st))]),_:1})],2),l("span",{class:O(e(Z)),onClick:a},[t(e(ae),null,{default:o(()=>[t(e(rt))]),_:1})],2)],64)),D(" ACTIONS "),l("div",{class:O([e(y).e("btn"),e(y).e("actions")])},[l("div",{class:O(e(y).e("actions__inner"))},[t(e(ae),{onClick:b[1]||(b[1]=_=>S("zoomOut"))},{default:o(()=>[t(e(it))]),_:1}),t(e(ae),{onClick:b[2]||(b[2]=_=>S("zoomIn"))},{default:o(()=>[t(e(Le))]),_:1}),l("i",{class:O(e(y).e("actions__divider"))},null,2),t(e(ae),{onClick:G},{default:o(()=>[(c(),z(Dt(e(F).icon)))]),_:1}),l("i",{class:O(e(y).e("actions__divider"))},null,2),t(e(ae),{onClick:b[3]||(b[3]=_=>S("anticlockwise"))},{default:o(()=>[t(e(ut))]),_:1}),t(e(ae),{onClick:b[4]||(b[4]=_=>S("clockwise"))},{default:o(()=>[t(e(dt))]),_:1})],2)],2),D(" CANVAS "),l("div",{class:O(e(y).e("canvas"))},[(c(!0),Y(le,null,ce(u.urlList,(_,J)=>Me((c(),Y("img",{ref_for:!0,ref:P=>V.value[J]=P,key:_,src:_,style:we(e(Q)),class:O(e(y).e("img")),crossorigin:u.crossorigin,onLoad:j,onError:X,onMousedown:k},null,46,Jt)),[[Yt,J===C.value]])),128))],2),fe(u.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var Qt=Be(Zt,[["__file","image-viewer.vue"]]);const ea=Fe(Qt),ta=Pe({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:me([String,Object])},previewSrcList:{type:me(Array),default:()=>je([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:me(String)}}),aa={load:r=>r instanceof Event,error:r=>r instanceof Event,switch:r=>he(r),close:()=>!0,show:()=>!0},la=["src","loading","crossorigin"],oa={key:0},na=_e({name:"ElImage",inheritAttrs:!1}),sa=_e({...na,props:ta,emits:aa,setup(r,{emit:h}){const p=r;let d="";const{t:m}=Ie(),w=Ue("image"),U=At(),y=mt(),B=N(),i=N(!1),V=N(!0),A=N(!1),E=N(),C=N(),F=ie&&"loading"in HTMLImageElement.prototype;let f,te;const R=T(()=>[w.e("inner"),x.value&&w.e("preview"),V.value&&w.is("loading")]),s=T(()=>U.style),I=T(()=>{const{fit:a}=p;return ie&&a?{objectFit:a}:{}}),x=T(()=>{const{previewSrcList:a}=p;return Array.isArray(a)&&a.length>0}),K=T(()=>{const{previewSrcList:a,initialIndex:S}=p;let u=S;return S>a.length-1&&(u=0),u}),Z=T(()=>p.loading==="eager"?!1:!F&&p.loading==="lazy"||p.lazy),Q=()=>{ie&&(V.value=!0,i.value=!1,B.value=p.src)};function ee(a){V.value=!1,i.value=!1,h("load",a)}function oe(a){V.value=!1,i.value=!0,h("error",a)}function W(){Ft(E.value,C.value)&&(Q(),k())}const j=pt(W,200,!0);async function X(){var a;if(!ie)return;await We();const{scrollContainer:S}=p;Tt(S)?C.value=S:Vt(S)&&S!==""?C.value=(a=document.querySelector(S))!=null?a:void 0:E.value&&(C.value=Ct(E.value)),C.value&&(f=ue(C,"scroll",j),setTimeout(()=>W(),100))}function k(){!ie||!C.value||!j||(f==null||f(),C.value=void 0)}function H(a){if(a.ctrlKey){if(a.deltaY<0)return a.preventDefault(),!1;if(a.deltaY>0)return a.preventDefault(),!1}}function G(){x.value&&(te=ue("wheel",H,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",A.value=!0,h("show"))}function L(){te==null||te(),document.body.style.overflow=d,A.value=!1,h("close")}function v(a){h("switch",a)}return ye(()=>p.src,()=>{Z.value?(V.value=!0,i.value=!1,k(),X()):Q()}),ge(()=>{Z.value?X():Q()}),(a,S)=>(c(),Y("div",{ref_key:"container",ref:E,class:O([e(w).b(),a.$attrs.class]),style:we(e(s))},[i.value?fe(a.$slots,"error",{key:0},()=>[l("div",{class:O(e(w).e("error"))},g(e(m)("el.image.error")),3)]):(c(),Y(le,{key:1},[B.value!==void 0?(c(),Y("img",zt({key:0},e(y),{src:B.value,loading:a.loading,style:e(I),class:e(R),crossorigin:a.crossorigin,onClick:G,onLoad:ee,onError:oe}),null,16,la)):D("v-if",!0),V.value?(c(),Y("div",{key:1,class:O(e(w).e("wrapper"))},[fe(a.$slots,"placeholder",{},()=>[l("div",{class:O(e(w).e("placeholder"))},null,2)])],2)):D("v-if",!0)],64)),e(x)?(c(),Y(le,{key:2},[A.value?(c(),z(e(ea),{key:0,"z-index":a.zIndex,"initial-index":e(K),infinite:a.infinite,"zoom-rate":a.zoomRate,"min-scale":a.minScale,"max-scale":a.maxScale,"url-list":a.previewSrcList,"hide-on-click-modal":a.hideOnClickModal,teleported:a.previewTeleported,"close-on-press-escape":a.closeOnPressEscape,onClose:L,onSwitch:v},{default:o(()=>[a.$slots.viewer?(c(),Y("div",oa,[fe(a.$slots,"viewer")])):D("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):D("v-if",!0)],64)):D("v-if",!0)],6))}});var ra=Be(sa,[["__file","image.vue"]]);const ia=Fe(ra),ua={class:"flex flex-row"},da={class:"table-auto",style:{"min-width":"360px"}},ca=l("td",{style:{width:"150px"},class:"border bg-blue-700 text-white px-4 py-1"}," Nomor Barcode ",-1),ma={class:"border bg-blue-100 px-4 py-1"},pa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"}," Jenis Kendaraan ",-1),fa={class:"border bg-blue-100 px-4 py-1"},_a=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Plat Nomor",-1),ga={class:"border bg-blue-100 px-4 py-1"},va=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Member",-1),ba={class:"border bg-blue-100 px-4 py-1"},ha=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Nomor Kartu",-1),ya={class:"border bg-blue-100 px-4 py-1"},wa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Gate Masuk",-1),ka={class:"border bg-blue-100 px-4 py-1"},xa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Gate Keluar",-1),Ca={class:"border bg-blue-100 px-4 py-1"},Sa=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Waktu Masuk",-1),Ta={class:"border bg-blue-100 px-4 py-1"},Ea=l("td",{class:"border bg-blue-700 text-white px-4 py-1"}," Waktu Keluar ",-1),Ma={class:"border bg-blue-100 px-4 py-1"},Da=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Durasi",-1),Ya={class:"border bg-blue-100 px-4 py-1"},Ia={key:0},La=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Tarif",-1),Aa={class:"border bg-blue-100 px-4 py-1"},za={key:1},Va=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Denda",-1),Na={class:"border bg-blue-100 px-4 py-1"},Ra=l("td",{class:"border bg-blue-700 text-white px-4 py-1"},"Operator",-1),$a={class:"border bg-blue-100 px-4 py-1"},Oa=["src"],Ka={__name:"DetailTransaksi",props:["trx","show"],emits:["close"],setup(r,{emit:h}){const p=Ee(),d=Xe(),m=h,{toRupiah:w}=ve(),U=T(()=>p.setting),y=T(()=>d.user.value);return(B,i)=>{const V=Te;return c(),z(V,{width:"80%","model-value":r.show,center:"",title:"DETAIL TRANSAKSI","before-close":A=>{m("close")}},{default:o(()=>[l("div",ua,[l("table",da,[l("tbody",null,[l("tr",null,[ca,l("td",ma,g(r.trx.nomor_barcode),1)]),l("tr",null,[pa,l("td",fa,g(r.trx.jenis_kendaraan),1)]),l("tr",null,[_a,l("td",ga,g(r.trx.plat_nomor),1)]),l("tr",null,[va,l("td",ba,g(r.trx.is_member?r.trx.member.nama:"Tidak"),1)]),l("tr",null,[ha,l("td",ya,g(r.trx.nomor_kartu),1)]),l("tr",null,[wa,l("td",ka,g(r.trx.gate_in?r.trx.gate_in.nama:""),1)]),l("tr",null,[xa,l("td",Ca,g(r.trx.gate_out?r.trx.gate_out.nama:""),1)]),l("tr",null,[Sa,l("td",Ta,g(e(pe)(r.trx.time_in).format("DD-MMM-YYYY HH:mm:ss")),1)]),l("tr",null,[Ea,l("td",Ma,g(r.trx.time_out?e(pe)(r.trx.time_out).format("DD-MMM-YYYY HH:mm:ss"):""),1)]),l("tr",null,[Da,l("td",Ya,g(r.trx.durasi),1)]),e(y).role==1?(c(),Y("tr",Ia,[La,l("td",Aa,g(e(w)(r.trx.tarif)),1)])):D("",!0),e(y).role==1?(c(),Y("tr",za,[Va,l("td",Na,g(e(w)(r.trx.denda)),1)])):D("",!0),l("tr",null,[Ra,l("td",$a,g(r.trx.operator),1)])])]),r.trx.snapshots?(c(),Y("div",{key:0,class:O({"ml-3":!0,"flex-grow":!0,flex:e(U).orientasi_kamera=="POTRAIT"}),style:{width:"100%"}},[(c(!0),Y(le,null,ce(r.trx.snapshots,A=>(c(),Y("div",{class:"mb-1",style:{width:"100%"},key:A.id},[l("img",{src:A.url,style:{width:"100%"}},null,8,Oa)]))),128))],2)):D("",!0)])]),_:1},8,["model-value","before-close"])}}},Ha={__name:"FormTransaksiManual",props:["show","model"],emits:["close","reload"],setup(r,{emit:h}){const{api:p,formErrors:d}=ve(),m=Ee(),w=h,{show:U,model:y}=r,B=N(!1),i=T(()=>y),V=T(()=>m.pos),A=T(()=>m.gateOutList),E=T(()=>m.gateInList),C=T(()=>m.jenisKendaraanList),F=()=>{d.value={},w("close")},f=()=>{B.value=!0,i.value.manual=1,p("/api/parkingTransaction",{method:"POST",body:i.value}).then(({data:R,message:s})=>{de({message:s,type:"success",showClose:!0}),F(),w("reload"),te(R.gate_out_id)}).catch(R=>{var s;((s=R.response)==null?void 0:s.status)==422?d.value=R.response._data.errors:console.log(R)}).finally(()=>B.value=!1)},te=R=>{const s=A.value.find(x=>x.id==R),I=new WebSocket(`ws://${V.value.ip_address}:5678/`);I.onerror=x=>{de({message:"KONEKSI KE POS GAGAL",type:"error"})},I.onopen=x=>{I.send(["open",s.device,s.baudrate,s.open_command,s.close_command].join(";"))},I.onmessage=x=>{let K=JSON.parse(x.data);de({message:K.message,type:K.status?"success":"error"}),I.close()}};return(R,s)=>{const I=xe,x=gt,K=Ot,Z=Kt,Q=Se,ee=Pt,oe=jt,W=vt,j=Ce,X=Te;return c(),z(X,{"close-on-click-modal":!1,title:e(i).id?"EDIT TRANSAKSI "+e(i).nomor_barcode:"TRANSAKSI MANUAL","model-value":r.show,width:"800px","before-close":k=>F()},{footer:o(()=>[t(j,{icon:e(ft),onClick:F},{default:o(()=>[M(" BATAL ")]),_:1},8,["icon"]),t(j,{type:"primary",icon:e(_t),onClick:f},{default:o(()=>[M(" SIMPAN ")]),_:1},8,["icon"])]),default:o(()=>[t(W,{"label-position":"left","label-width":"150px"},{default:o(()=>[t(oe,{gutter:30},{default:o(()=>[t(ee,{span:12},{default:o(()=>{var k,H,G,L,v;return[t(x,{label:"Plat Nomor",error:(k=e(d).plat_nomor)==null?void 0:k.join(", ")},{default:o(()=>[t(I,{placeholder:"Plat Nomor",modelValue:e(i).plat_nomor,"onUpdate:modelValue":s[0]||(s[0]=a=>e(i).plat_nomor=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Gate Masuk",error:(H=e(d).gate_in_id)==null?void 0:H.join(", ")},{default:o(()=>[t(Z,{modelValue:e(i).gate_in_id,"onUpdate:modelValue":s[1]||(s[1]=a=>e(i).gate_in_id=a),placeholder:"Gate Masuk",style:{width:"100%"}},{default:o(()=>[(c(!0),Y(le,null,ce(e(E),(a,S)=>(c(),z(K,{value:a.id,label:a.nama,key:S},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Waktu Masuk",error:(G=e(d).time_in)==null?void 0:G.join(", ")},{default:o(()=>[t(Q,{type:"datetime",style:{width:"100%"},format:"DD-MMM-YYYY HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"Waktu Masuk",modelValue:e(i).time_in,"onUpdate:modelValue":s[2]||(s[2]=a=>e(i).time_in=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Tarif (Rp)",error:(L=e(d).tarif)==null?void 0:L.join(", ")},{default:o(()=>[t(I,{type:"number",placeholder:"Tarif",modelValue:e(i).tarif,"onUpdate:modelValue":s[3]||(s[3]=a=>e(i).tarif=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"User Admin",error:(v=e(d).username)==null?void 0:v.join(", ")},{default:o(()=>[t(I,{placeholder:"User Admin",modelValue:e(i).username,"onUpdate:modelValue":s[4]||(s[4]=a=>e(i).username=a)},null,8,["modelValue"])]),_:1},8,["error"])]}),_:1}),t(ee,{span:12},{default:o(()=>{var k,H,G,L,v;return[t(x,{label:"Jenis Kendaraan",error:(k=e(d).jenis_kendaraan)==null?void 0:k.join(", ")},{default:o(()=>[t(Z,{modelValue:e(i).jenis_kendaraan,"onUpdate:modelValue":s[5]||(s[5]=a=>e(i).jenis_kendaraan=a),placeholder:"Jenis Kendaraan",style:{width:"100%"}},{default:o(()=>[(c(!0),Y(le,null,ce(e(C),(a,S)=>(c(),z(K,{value:a.nama,label:a.nama,key:S},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Gate Keluar",error:(H=e(d).gate_out_id)==null?void 0:H.join(", ")},{default:o(()=>[t(Z,{modelValue:e(i).gate_out_id,"onUpdate:modelValue":s[6]||(s[6]=a=>e(i).gate_out_id=a),placeholder:"Gate Keluar",style:{width:"100%"}},{default:o(()=>[(c(!0),Y(le,null,ce(e(A),(a,S)=>(c(),z(K,{value:a.id,label:a.nama,key:S},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Waktu Keluar",error:(G=e(d).time_out)==null?void 0:G.join(", ")},{default:o(()=>[t(Q,{type:"datetime",autocomplete:!1,style:{width:"100%"},format:"DD-MMM-YYYY HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",placeholder:"Waktu Keluar",modelValue:e(i).time_out,"onUpdate:modelValue":s[7]||(s[7]=a=>e(i).time_out=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Denda (Rp)",error:(L=e(d).denda)==null?void 0:L.join(", ")},{default:o(()=>[t(I,{type:"number",placeholder:"Denda",modelValue:e(i).denda,"onUpdate:modelValue":s[8]||(s[8]=a=>e(i).denda=a)},null,8,["modelValue"])]),_:1},8,["error"]),t(x,{label:"Password Admin",error:(v=e(d).password)==null?void 0:v.join(", ")},{default:o(()=>[t(I,{type:"password",placeholder:"Password Admin",modelValue:e(i).password,"onUpdate:modelValue":s[9]||(s[9]=a=>e(i).password=a)},null,8,["modelValue"])]),_:1},8,["error"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["title","model-value","before-close"])}}},Pa={class:"mr-2"},ja=l("br",null,null,-1),Ua=l("br",null,null,-1),Ba=l("br",null,null,-1),Fa={key:0,style:{"font-weight":"bold"}},Wa=l("br",null,null,-1),Xa=l("br",null,null,-1),Ga={class:"el-dropdown-link"},Ja=l("br",null,null,-1),qa={__name:"ParkingTransaction",setup(r){const h=Ee(),p=Xe(),{api:d,showForm:m,formErrors:w,formModel:U,page:y,pageSize:B,tableData:i,loading:V,filters:A,keyword:E,openForm:C,currentChange:F,sizeChange:f,sortChange:te,filterChange:R,requestData:s,searchData:I,refreshData:x,toRupiah:K}=ve("/api/parkingTransaction"),Z=T(()=>h.jenisKendaraanList),Q=T(()=>h.gateInList),ee=T(()=>h.gateOutList),oe=T(()=>h.shiftList),W=T(()=>p.user.value),j=N(null),X=N(null);Nt(()=>{h.getShiftList(),h.getPos()}),ge(()=>{A.value.dateRange=[],s()});const k=L=>{De.confirm("Anda yakin?","Confirm",{type:"warning"}).then(()=>d(`/api/parkingTransaction/setSudahKeluar/${L}`,{method:"PUT"})).then(v=>{de({message:v.message,type:"success"}),s()})},H=()=>{De.confirm("Anda yakin?","Confirm",{type:"warning"}).then(()=>d("/api/parkingTransaction/setSudahKeluarSemua",{method:"PUT",body:{"dateRange[0]":dateRange.value[0],"dateRange[1]":dateRange.value[1]}})).then(L=>{de({message:L.message,type:"success"}),s()}).catch(L=>console.log(L))},G=L=>{d(`/api/parkingTransaction/printTicketOut/${L}`,{method:"POST"}).then(v=>{de({message:v.message,type:"success"})})};return(L,v)=>{const a=Ce,S=Se,u=St,b=xe,_=Ne,J=ae,P=Oe,$=Ke,q=He,ne=Re,Je=$e,qe=Ka,Ze=Ha,Qe=Ge;return c(),Y("div",null,[l("form",{class:"flex justify-content-end mb-3",onSubmit:v[3]||(v[3]=se(()=>{},["prevent"]))},[t(a,{size:"small",type:"primary",icon:e(bt),onClick:v[0]||(v[0]=n=>e(C)({})),class:"mr-2"},{default:o(()=>[M(" TRANSAKSI MANUAL ")]),_:1},8,["icon"]),l("div",Pa,[t(S,{size:"small",onChange:e(s),modelValue:e(A).dateRange,"onUpdate:modelValue":v[1]||(v[1]=n=>e(A).dateRange=n),format:"DD-MMM-YYYY HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"Dari","end-placeholder":"Sampai"},null,8,["onChange","modelValue"])]),e(W).role==1?(c(),z(u,{key:0,class:"item",effect:"dark",content:"Set kendaraan sudah keluar untuk waktu terpilih",placement:"bottom"},{default:o(()=>[t(a,{size:"small",type:"danger",icon:e(ht),onClick:H,class:"mr-2"},null,8,["icon"])]),_:1})):D("",!0),t(b,{size:"small",modelValue:e(E),"onUpdate:modelValue":v[2]||(v[2]=n=>ke(E)?E.value=n:null),placeholder:"Cari","prefix-icon":e(Ae),clearable:!0,onChange:e(I),style:{width:"150px"}},null,8,["modelValue","prefix-icon","onChange"])],32),Me((c(),z(ne,{data:e(i).data,stripe:"",onRowDblclick:v[4]||(v[4]=n=>{j.value=n,X.value=!0}),onFilterChange:e(R),height:"calc(100vh - 280px)",onSortChange:e(te)},{default:o(()=>[t(_,{label:"No. Tiket",sortable:"custom",filters:e(Z).map(n=>({value:n.nama,text:n.nama})),"column-key":"jenis_kendaraan","min-width":"150","show-overflow-tooltip":""},{default:o(({row:n})=>[l("strong",null,g(n.nomor_barcode),1),ja,M(" "+g(n.jenis_kendaraan)+" "+g(n.plat_nomor?`- ${n.plat_nomor}`:""),1)]),_:1},8,["filters"]),t(_,{prop:"time_in",label:"Masuk",sortable:"custom","show-overflow-tooltip":"","min-width":"140px","column-key":"gate_in_id",filters:e(Q).map(n=>({value:n.id,text:n.nama}))},{default:o(({row:n})=>[M(g(e(pe)(n.time_in).format("DD/MMM/YY HH:mm"))+" ",1),Ua,M(" "+g(n.gate_in.nama),1)]),_:1},8,["filters"]),t(_,{prop:"time_out",label:"Keluar",sortable:"custom","show-overflow-tooltip":"","min-width":"140px","column-key":"gate_out_id",filters:e(ee).map(n=>({value:n.id,text:n.nama}))},{default:o(({row:n})=>[M(g(n.time_out?e(pe)(n.time_out).format("DD/MMM/YY HH:mm"):"")+" ",1),Ba,M(" "+g(n.gate_out?n.gate_out.nama:"-"),1)]),_:1},8,["filters"]),t(_,{label:"Durasi","show-overflow-tooltip":"",prop:"parking_transactions.tarif",sortable:"custom","min-width":"120px"},{default:o(({row:n})=>[M(g(n.durasi)+" ",1),e(W).role==1?(c(),Y("div",Fa,g(e(K)(n.tarif)),1)):D("",!0)]),_:1}),e(W).role==1?(c(),z(_,{key:0,prop:"denda",label:"Denda",align:"right","column-key":"denda",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"header-align":"right","min-width":"100px"},{default:o(({row:n})=>[M(g(e(K)(n.denda)),1)]),_:1})):D("",!0),t(_,{label:"Member",sortable:"custom","show-overflow-tooltip":"","min-width":"120"},{default:o(({row:n})=>[l("strong",null,g(n.member?n.member.nama:""),1),M(),Wa,M(" "+g(n.nomor_kartu),1)]),_:1}),t(_,{prop:"operator",label:"Operator","show-overflow-tooltip":"","min-width":"90"}),t(_,{label:"Shift",prop:"shift.nama","column-key":"shift_id","min-width":"80",filters:e(oe).map(n=>({value:n.id,text:n.nama}))},null,8,["filters"]),t(_,{label:"Edit",align:"center","header-align":"center","column-key":"edit",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"min-width":"100px"},{default:o(({row:n})=>[M(g(n.edit?"YA":"TIDAK")+" ",1),Xa,M(" "+g(n.edit_by),1)]),_:1}),t(_,{label:"Manual",align:"center","header-align":"center","column-key":"manual",filters:[{value:"Y",text:"YA"},{value:"T",text:"TIDAK"}],"filter-multiple":!1,"min-width":"100px"},{default:o(({row:n})=>[M(g(n.manual?"YA":"TIDAK"),1)]),_:1}),t(_,{fixed:"right",width:"60px",align:"center","header-align":"center"},{header:o(()=>[t(a,{link:"",onClick:e(x),icon:e(ze)},null,8,["onClick","icon"])]),default:o(({row:n})=>[t(q,null,{dropdown:o(()=>[t($,null,{default:o(()=>[t(P,{icon:e(Le),onClick:se(()=>{j.value=n,X.value=!0},["prevent"])},{default:o(()=>[M(" Lihat Detail ")]),_:2},1032,["icon","onClick"]),!n.time_out&&e(W).role==1?(c(),z(P,{key:0,icon:e(yt),onClick:se(et=>k(n.id),["prevent"])},{default:o(()=>[M(" Set Sudah Keluar ")]),_:2},1032,["icon","onClick"])):D("",!0),!n.is_member&&!n.edit&&!n.manual?(c(),z(P,{key:1,icon:e(wt),onClick:se(()=>{U.value={...n},w.value={},m.value=!0},["prevent"])},{default:o(()=>[M(" Edit ")]),_:2},1032,["icon","onClick"])):D("",!0),!n.is_member&&n.time_out?(c(),z(P,{key:2,icon:e(kt),onClick:se(et=>G(n.id),["prevent"])},{default:o(()=>[M(" Print Tiket Keluar ")]),_:2},1032,["icon","onClick"])):D("",!0)]),_:2},1024)]),default:o(()=>[l("span",Ga,[t(J,null,{default:o(()=>[t(e(Ve))]),_:1})])]),_:2},1024)]),_:1})]),_:1},8,["data","onFilterChange","onSortChange"])),[[Qe,e(V)]]),Ja,t(Je,{small:"",background:"","current-page":e(y),onCurrentChange:e(F),onSizeChange:e(f),layout:"total, sizes, prev, pager, next","page-size":e(B),"page-sizes":[10,25,50,100],total:e(i).total},null,8,["current-page","onCurrentChange","onSizeChange","page-size","total"]),e(j)?(c(),z(qe,{key:0,trx:e(j),show:e(X),onClose:v[5]||(v[5]=n=>X.value=!1)},null,8,["trx","show"])):D("",!0),e(m)?(c(),z(Ze,{key:1,show:e(m),model:e(U),onClose:v[6]||(v[6]=n=>m.value=!1),onReload:e(s)},null,8,["show","model","onReload"])):D("",!0)])}}},Za={class:"el-dropdown-link"},Qa=l("br",null,null,-1),el=l("div",{slot:"error",class:"el-image__error"},[l("i",{class:"el-icon-picture-outline"})],-1),tl={__name:"ManualOpenLog",setup(r){const{pageSize:h,tableData:p,loading:d,filters:m,keyword:w,currentChange:U,sizeChange:y,sortChange:B,requestData:i,refreshData:V,searchData:A}=ve("/api/manualOpenLog"),E=N(!1),C=N([]);return ge(()=>{m.value.dateRange=[],i()}),(F,f)=>{const te=Se,R=xe,s=Ne,I=Ce,x=ae,K=Oe,Z=Ke,Q=He,ee=Re,oe=$e,W=ia,j=Te,X=Ge;return c(),Y(le,null,[l("form",{class:"flex justify-content-end mb-3",onSubmit:f[2]||(f[2]=se(()=>{},["prevent"]))},[l("div",null,[t(te,{size:"small",onChange:e(i),modelValue:e(m).dateRange,"onUpdate:modelValue":f[0]||(f[0]=k=>e(m).dateRange=k),format:"DD-MMM-YYYY HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",type:"datetimerange","range-separator":"-","start-placeholder":"Dari","end-placeholder":"Sampai",class:"mr-2"},null,8,["onChange","modelValue"])]),t(R,{size:"small",modelValue:e(w),"onUpdate:modelValue":f[1]||(f[1]=k=>ke(w)?w.value=k:null),placeholder:"Cari","prefix-icon":e(Ae),clearable:"",onChange:e(A),style:{width:"200px"}},null,8,["modelValue","prefix-icon","onChange"])],32),Me((c(),z(ee,{data:e(p).data,stripe:"",onRowDblclick:f[3]||(f[3]=(k,H,G)=>{C.value=k.snapshots,E.value=!0}),height:"calc(100vh - 280px)",onSortChange:e(B)},{default:o(()=>[t(s,{type:"index",index:e(p).from,label:"#"},null,8,["index"]),t(s,{prop:"created_at",label:"Tanggal",sortable:"custom","show-overflow-tooltip":"",width:"180px"},{default:o(({row:k})=>[M(g(e(pe)(k.created_at).format("DD-MMM-YYYY HH:mm:ss")),1)]),_:1}),t(s,{prop:"gate_out.nama",label:"Gate Out","show-overflow-tooltip":"","min-width":"150px"}),t(s,{prop:"user.name",label:"Operator","show-overflow-tooltip":"","min-width":"150px"}),t(s,{prop:"alasan",label:"Alasan",sortable:"custom","show-overflow-tooltip":"","min-width":"150px"}),t(s,{fixed:"right",width:"60px",align:"center","header-align":"center"},{header:o(()=>[t(I,{link:"",onClick:e(V),icon:e(ze)},null,8,["onClick","icon"])]),default:o(({row:k})=>[t(Q,null,{dropdown:o(()=>[t(Z,null,{default:o(()=>[t(K,{icon:e(xt),onClick:se(()=>{C.value=k.snapshots,E.value=!0},["prevent"])},{default:o(()=>[M("Lihat Snapshot")]),_:2},1032,["icon","onClick"])]),_:2},1024)]),default:o(()=>[l("span",Za,[t(x,null,{default:o(()=>[t(e(Ve))]),_:1})])]),_:2},1024)]),_:1})]),_:1},8,["data","onSortChange"])),[[X,e(d)]]),Qa,t(oe,{small:"",background:"",onCurrentChange:e(U),onSizeChange:e(y),layout:"total, sizes, prev, pager, next","page-size":e(h),"page-sizes":[10,25,50,100],total:e(p).total},null,8,["onCurrentChange","onSizeChange","page-size","total"]),t(j,{center:"",modelValue:e(E),"onUpdate:modelValue":f[4]||(f[4]=k=>ke(E)?E.value=k:null),title:"SNAPSHOT"},{default:o(()=>[(c(!0),Y(le,null,ce(e(C),(k,H)=>(c(),z(W,{key:H,src:k.url,style:{width:"100%",height:"100%"},fit:"cover"},{default:o(()=>[el]),_:2},1032,["src"]))),128))]),_:1},8,["modelValue"])],64)}}},al={};function ll(r,h){const p=qa,d=Ut,m=tl,w=Bt,U=Ht;return c(),z(U,null,{default:o(()=>[t(w,null,{default:o(()=>[t(d,{label:"TRANSAKSI PARKIR"},{default:o(()=>[t(p)]),_:1}),t(d,{label:"BUKA MANUAL"},{default:o(()=>[t(m)]),_:1})]),_:1})]),_:1})}const yl=Rt(al,[["render",ll]]);export{yl as default};
